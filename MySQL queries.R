# Load packages that extend base R
library("RMySQL")

# Set working directory
setwd(choose.dir())

# Connect to MySQL database
mydb <- dbConnect(MySQL(), user = "", password = "", dbname = "", host = "")

# List tables in database
dbListTables(mydb)

# Query the database
q_statement <- "
  SELECT
    cp.nickname AS 'Nickname', 
    MAX(if(cpm.meta_key_id = 13, cpm.meta_value, NULL)) AS 'Test Date', 
    MAX(if(cpm.meta_key_id = 13, cpm.time_point, NULL)) AS 'Time Point', 
    MAX(if(cpm.meta_key_id = 169, cpm.meta_value, NULL)) AS 'Age (Years)',
    MAX(if(cpm.meta_key_id = 6029, cpm.meta_value, NULL)) AS 'Age (Decimal Years)',
    MAX(if(cpm.meta_key_id = 6030, cpm.meta_value, NULL)) AS 'Age (Age Months)',
    MAX(if(cpm.meta_key_id = 168, cpm.meta_value, NULL)) AS 'Birth Month',
    MAX(if(cpm.meta_key_id = 167, if(cpm.meta_value = 'Boy',1,if(cpm.meta_value = 'Girl',2,NULL)), NULL)) AS 'Gender',
    MAX(if(cpm.meta_key_id = 166, cpm.meta_value, NULL)) AS 'School Grade',
    MAX(if(cpm.meta_key_id = 157, cpm.meta_value, NULL)) AS 'Province/State',
    MAX(if(cpm.meta_key_id = 158, cpm.meta_value, NULL)) AS 'Country',
    MAX(if(cpm.meta_key_id = 159, cpm.meta_value, NULL)) AS 'Location Type',
    MAX(if(cpm.meta_key_id = 180, cpm.meta_value, NULL)) AS 'PE Teacher Credentials',
    MAX(if(cpm.meta_key_id = 170, cpm.meta_value, NULL)) AS 'Notes',
    MAX(if(cpm.meta_key_id = 15, cpm.meta_value, NULL)) AS 'Sit and Reach 1 (cm)',
    MAX(if(cpm.meta_key_id = 16, cpm.meta_value, NULL)) AS 'Sit and Reach 2 (cm)',
    MAX(if(cpm.meta_key_id = 3001, cpm.meta_value, NULL)) AS 'Sit and Reach Max Score (cm)',
    MAX(if(cpm.meta_key_id = 3002, cpm.meta_value, NULL)) AS 'Sit and Reach Score',
    MAX(if(cpm.meta_key_id = 3003, cpm.meta_value, NULL)) AS 'Sit and Reach Interpretation',
    MAX(if(cpm.meta_key_id = 17, cpm.meta_value, NULL)) AS 'Left Handgrip 1 (kg)',
    MAX(if(cpm.meta_key_id = 18, cpm.meta_value, NULL)) AS 'Left Handgrip 2 (kg)',
    MAX(if(cpm.meta_key_id = 3004, cpm.meta_value, NULL)) AS 'Left Handgrip Strength Max Score (kg)',
    MAX(if(cpm.meta_key_id = 19, cpm.meta_value, NULL)) AS 'Right Handgrip 1 (kg)',
    MAX(if(cpm.meta_key_id = 20, cpm.meta_value, NULL)) AS 'Right Handgrip 2 (kg)',
    MAX(if(cpm.meta_key_id = 3005, cpm.meta_value, NULL)) AS 'Right Handgrip Strength Max Score (kg)',			
    MAX(if(cpm.meta_key_id = 3006, cpm.meta_value, NULL)) AS 'Total Handgrip Strength (kg)',			
    MAX(if(cpm.meta_key_id = 3007, cpm.meta_value, NULL)) AS 'Handgrip Strength Score',			
    MAX(if(cpm.meta_key_id = 3008, cpm.meta_value, NULL)) AS 'Handgrip Strength Interpretation',			
    MAX(if(cpm.meta_key_id = 21, cpm.meta_value, NULL)) AS 'PACER Shuttle Run Distance (m)',
    MAX(if(cpm.meta_key_id = 22, cpm.meta_value, NULL)) AS 'PACER Shuttle Run Laps',
    MAX(if(cpm.meta_key_id = 3009, cpm.meta_value, NULL)) AS 'PACER Shuttle Run Laps (20m Conversion)',			
    MAX(if(cpm.meta_key_id = 3010, cpm.meta_value, NULL)) AS 'PACER Shuttle Run Score',			
    MAX(if(cpm.meta_key_id = 3011, cpm.meta_value, NULL)) AS 'PACER Shuttle Run Interpretation',	
    MAX(if(cpm.meta_key_id = 23, cpm.meta_value, NULL)) AS 'Plank Time (s)',
    MAX(if(cpm.meta_key_id = 3012, cpm.meta_value, NULL)) AS 'Plank Time Score',	
    MAX(if(cpm.meta_key_id = 3013, cpm.meta_value, NULL)) AS 'Plank Time Interpretation',	
    MAX(if(cpm.meta_key_id = 3014, cpm.meta_value, NULL)) AS 'Musculoskeletal Fitness Score',	
    MAX(if(cpm.meta_key_id = 24, cpm.meta_value, NULL)) AS 'Standing Height 1 (cm)',
    MAX(if(cpm.meta_key_id = 151, cpm.meta_value, NULL)) AS 'Standing Height 2 (cm)',
    MAX(if(cpm.meta_key_id = 152, cpm.meta_value, NULL)) AS 'Standing Height 3 (cm)',
    MAX(if(cpm.meta_key_id = 3029, cpm.meta_value, NULL)) AS 'Average Standing Height (cm)',
    MAX(if(cpm.meta_key_id = 25, cpm.meta_value, NULL)) AS 'Body Weight 1 (kg)',
    MAX(if(cpm.meta_key_id = 153, cpm.meta_value, NULL)) AS 'Body Weight 2 (kg)',
    MAX(if(cpm.meta_key_id = 156, cpm.meta_value, NULL)) AS 'Body Weight 3 (kg)',
    MAX(if(cpm.meta_key_id = 3030, cpm.meta_value, NULL)) AS 'Average Body Weight (kg)',
    MAX(if(cpm.meta_key_id = 3015, cpm.meta_value, NULL)) AS 'Body Mass Index (kg/m^2)',	
    MAX(if(cpm.meta_key_id = 3032, cpm.meta_value, NULL)) AS 'Body Mass Index Z Score',	
    MAX(if(cpm.meta_key_id = 3016, cpm.meta_value, NULL)) AS 'Body Mass Index Score',	
    MAX(if(cpm.meta_key_id = 3017, cpm.meta_value, NULL)) AS 'Body Mass Index Interpretation',	
    MAX(if(cpm.meta_key_id = 26, cpm.meta_value, NULL)) AS 'Waist Circumference 1 (cm)',
    MAX(if(cpm.meta_key_id = 154, cpm.meta_value, NULL)) AS 'Waist Circumference 2 (cm)',
    MAX(if(cpm.meta_key_id = 155, cpm.meta_value, NULL)) AS 'Waist Circumference 3 (cm)',
    MAX(if(cpm.meta_key_id = 3031, cpm.meta_value, NULL)) AS 'Average Waist Circumference (cm)',
    MAX(if(cpm.meta_key_id = 3018, cpm.meta_value, NULL)) AS 'Waist Circumference Score',	
    MAX(if(cpm.meta_key_id = 3019, cpm.meta_value, NULL)) AS 'Waist Circumference Interpretation',	
    MAX(if(cpm.meta_key_id = 3020, cpm.meta_value, NULL)) AS 'Body Composition Score',	
    MAX(if(cpm.meta_key_id = 27, cpm.meta_value, NULL)) AS 'Obstacle Course Time 1 (s)',
    MAX(if(cpm.meta_key_id = 28, cpm.meta_value, NULL)) AS 'Obstacle Course Score 1',
    MAX(if(cpm.meta_key_id = 3023, cpm.meta_value, NULL)) AS 'Obstacle Course 1 Composite Score',
    MAX(if(cpm.meta_key_id = 182, cpm.meta_value, NULL)) AS 'Jumping Criterion 1 (Trial 1)',
    MAX(if(cpm.meta_key_id = 184, cpm.meta_value, NULL)) AS 'Jumping Criterion 2 (Trial 1)',
    MAX(if(cpm.meta_key_id = 186, cpm.meta_value, NULL)) AS 'Sliding Criterion 1 (Trial 1)',
    MAX(if(cpm.meta_key_id = 188, cpm.meta_value, NULL)) AS 'Sliding Criterion 2 (Trial 1)',
    MAX(if(cpm.meta_key_id = 190, cpm.meta_value, NULL)) AS 'Sliding Criterion 3 (Trial 1)',
    MAX(if(cpm.meta_key_id = 192, cpm.meta_value, NULL)) AS 'Catching Criterion (Trial 1)',
    MAX(if(cpm.meta_key_id = 194, cpm.meta_value, NULL)) AS 'Throwing Criterion 1 (Trial 1)',
    MAX(if(cpm.meta_key_id = 196, cpm.meta_value, NULL)) AS 'Throwing Criterion 2 (Trial 1)',
    MAX(if(cpm.meta_key_id = 198, cpm.meta_value, NULL)) AS 'Skipping Criterion 1 (Trial 1)',
    MAX(if(cpm.meta_key_id = 200, cpm.meta_value, NULL)) AS 'Skipping Criterion 2 (Trial 1)',
    MAX(if(cpm.meta_key_id = 202, cpm.meta_value, NULL)) AS 'Hopping Criterion 1 (Trial 1)',
    MAX(if(cpm.meta_key_id = 204, cpm.meta_value, NULL)) AS 'Hopping Criterion 2 (Trial 1)',
    MAX(if(cpm.meta_key_id = 206, cpm.meta_value, NULL)) AS 'Kicking Criterion 1 (Trial 1)',
    MAX(if(cpm.meta_key_id = 208, cpm.meta_value, NULL)) AS 'Kicking Criterion 2 (Trial 1)',
    MAX(if(cpm.meta_key_id = 29, cpm.meta_value, NULL)) AS 'Obstacle Course Time 2 (s)',
    MAX(if(cpm.meta_key_id = 30, cpm.meta_value, NULL)) AS 'Obstacle Course Score 2',
    MAX(if(cpm.meta_key_id = 3024, cpm.meta_value, NULL)) AS 'Obstacle Course 2 Composite Score',
    MAX(if(cpm.meta_key_id = 183, cpm.meta_value, NULL)) AS 'Jumping Criterion 1 (Trial 2)',
    MAX(if(cpm.meta_key_id = 185, cpm.meta_value, NULL)) AS 'Jumping Criterion 2 (Trial 2)',
    MAX(if(cpm.meta_key_id = 187, cpm.meta_value, NULL)) AS 'Sliding Criterion 1 (Trial 2)',
    MAX(if(cpm.meta_key_id = 189, cpm.meta_value, NULL)) AS 'Sliding Criterion 2 (Trial 2)',
    MAX(if(cpm.meta_key_id = 191, cpm.meta_value, NULL)) AS 'Sliding Criterion 3 (Trial 2)',
    MAX(if(cpm.meta_key_id = 193, cpm.meta_value, NULL)) AS 'Catching Criterion (Trial 2)',
    MAX(if(cpm.meta_key_id = 195, cpm.meta_value, NULL)) AS 'Throwing Criterion 1 (Trial 2)',
    MAX(if(cpm.meta_key_id = 197, cpm.meta_value, NULL)) AS 'Throwing Criterion 2 (Trial 2)',
    MAX(if(cpm.meta_key_id = 199, cpm.meta_value, NULL)) AS 'Skipping Criterion 1 (Trial 2)',
    MAX(if(cpm.meta_key_id = 201, cpm.meta_value, NULL)) AS 'Skipping Criterion 2 (Trial 2)',
    MAX(if(cpm.meta_key_id = 203, cpm.meta_value, NULL)) AS 'Hopping Criterion 1 (Trial 2)',
    MAX(if(cpm.meta_key_id = 205, cpm.meta_value, NULL)) AS 'Hopping Criterion 2 (Trial 2)',
    MAX(if(cpm.meta_key_id = 207, cpm.meta_value, NULL)) AS 'Kicking Criterion 1 (Trial 2)',
    MAX(if(cpm.meta_key_id = 209, cpm.meta_value, NULL)) AS 'Kicking Criterion 2 (Trial 2)',
    MAX(if(cpm.meta_key_id = 3025, cpm.meta_value, NULL)) AS 'Obstacle Course Score',
    MAX(if(cpm.meta_key_id = 3026, cpm.meta_value, NULL)) AS 'Obstacle Course Interpretation',
    MAX(if(cpm.meta_key_id = 3033, cpm.meta_value, NULL)) AS 'Physical Competence Complete Data',
    MAX(if(cpm.meta_key_id = 3027, cpm.meta_value, NULL)) AS 'Physical Competence Score',
    MAX(if(cpm.meta_key_id = 3028, cpm.meta_value, NULL)) AS 'Physical Competence Interpretation',
    MAX(if(cpm.meta_key_id = 31, cpm.meta_value, NULL)) AS 'Step Counts (Day 1)',
    MAX(if(cpm.meta_key_id = 32, cpm.meta_value, NULL)) AS 'Time On (Day 1)',
    MAX(if(cpm.meta_key_id = 33, cpm.meta_value, NULL)) AS 'Time Off (Day 1)',
    MAX(if(cpm.meta_key_id = 34, cpm.meta_value, NULL)) AS 'Non Wear Time (Day 1)',
    MAX(if(cpm.meta_key_id = 35, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Day 1)',
    MAX(if(cpm.meta_key_id = 4001, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Day 1)',
    MAX(if(cpm.meta_key_id = 4002, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Day 1)',
    MAX(if(cpm.meta_key_id = 4003, cpm.meta_value, NULL)) AS 'Time Worn Score (Day 1)',
    MAX(if(cpm.meta_key_id = 4004, cpm.meta_value, NULL)) AS 'Step Counts Score (Day 1)',
    MAX(if(cpm.meta_key_id = 36, cpm.meta_value, NULL)) AS 'Step Counts (Day 2)',
    MAX(if(cpm.meta_key_id = 37, cpm.meta_value, NULL)) AS 'Time On (Day 2)',
    MAX(if(cpm.meta_key_id = 38, cpm.meta_value, NULL)) AS 'Time Off (Day 2)',
    MAX(if(cpm.meta_key_id = 39, cpm.meta_value, NULL)) AS 'Non Wear Time (Day 2)',
    MAX(if(cpm.meta_key_id = 40, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Day 2)',
    MAX(if(cpm.meta_key_id = 4005, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Day 2)',
    MAX(if(cpm.meta_key_id = 4006, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Day 2)',
    MAX(if(cpm.meta_key_id = 4007, cpm.meta_value, NULL)) AS 'Time Worn Score (Day 2)',
    MAX(if(cpm.meta_key_id = 4008, cpm.meta_value, NULL)) AS 'Step Counts Score (Day 2)',
    MAX(if(cpm.meta_key_id = 41, cpm.meta_value, NULL)) AS 'Step Counts (Day 3)',
    MAX(if(cpm.meta_key_id = 42, cpm.meta_value, NULL)) AS 'Time On (Day 3)',
    MAX(if(cpm.meta_key_id = 43, cpm.meta_value, NULL)) AS 'Time Off (Day 3)',
    MAX(if(cpm.meta_key_id = 44, cpm.meta_value, NULL)) AS 'Non Wear Time (Day 3)',
    MAX(if(cpm.meta_key_id = 45, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Day 3)',
    MAX(if(cpm.meta_key_id = 4009, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Day 3)',
    MAX(if(cpm.meta_key_id = 4010, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Day 3)',
    MAX(if(cpm.meta_key_id = 4011, cpm.meta_value, NULL)) AS 'Time Worn Score (Day 3)',
    MAX(if(cpm.meta_key_id = 4012, cpm.meta_value, NULL)) AS 'Step Counts Score (Day 3)',
    MAX(if(cpm.meta_key_id = 46, cpm.meta_value, NULL)) AS 'Step Counts (Day 4)',
    MAX(if(cpm.meta_key_id = 47, cpm.meta_value, NULL)) AS 'Time On (Day 4)',
    MAX(if(cpm.meta_key_id = 48, cpm.meta_value, NULL)) AS 'Time Off (Day 4)',
    MAX(if(cpm.meta_key_id = 49, cpm.meta_value, NULL)) AS 'Non Wear Time (Day 4)',
    MAX(if(cpm.meta_key_id = 50, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Day 4)',
    MAX(if(cpm.meta_key_id = 4013, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Day 4)',
    MAX(if(cpm.meta_key_id = 4014, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Day 4)',
    MAX(if(cpm.meta_key_id = 4015, cpm.meta_value, NULL)) AS 'Time Worn Score (Day 4)',
    MAX(if(cpm.meta_key_id = 4016, cpm.meta_value, NULL)) AS 'Step Counts Score (Day 4)',
    MAX(if(cpm.meta_key_id = 51, cpm.meta_value, NULL)) AS 'Step Counts (Day 5)',
    MAX(if(cpm.meta_key_id = 52, cpm.meta_value, NULL)) AS 'Time On (Day 5)',
    MAX(if(cpm.meta_key_id = 53, cpm.meta_value, NULL)) AS 'Time Off (Day 5)',
    MAX(if(cpm.meta_key_id = 54, cpm.meta_value, NULL)) AS 'Non Wear Time (Day 5)',
    MAX(if(cpm.meta_key_id = 55, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Day 5)',
    MAX(if(cpm.meta_key_id = 4017, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Day 5)',
    MAX(if(cpm.meta_key_id = 4018, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Day 5)',
    MAX(if(cpm.meta_key_id = 4019, cpm.meta_value, NULL)) AS 'Time Worn Score (Day 5)',
    MAX(if(cpm.meta_key_id = 4020, cpm.meta_value, NULL)) AS 'Step Counts Score (Day 5)',
    MAX(if(cpm.meta_key_id = 56, cpm.meta_value, NULL)) AS 'Step Counts (Day 6)',
    MAX(if(cpm.meta_key_id = 57, cpm.meta_value, NULL)) AS 'Time On (Day 6)',
    MAX(if(cpm.meta_key_id = 58, cpm.meta_value, NULL)) AS 'Time Off (Day 6)',
    MAX(if(cpm.meta_key_id = 59, cpm.meta_value, NULL)) AS 'Non Wear Time (Day 6)',
    MAX(if(cpm.meta_key_id = 60, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Day 6)',
    MAX(if(cpm.meta_key_id = 4021, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Day 6)',
    MAX(if(cpm.meta_key_id = 4022, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Day 6)',
    MAX(if(cpm.meta_key_id = 4023, cpm.meta_value, NULL)) AS 'Time Worn Score (Day 6)',
    MAX(if(cpm.meta_key_id = 4024, cpm.meta_value, NULL)) AS 'Step Counts Score (Day 6)',
    MAX(if(cpm.meta_key_id = 61, cpm.meta_value, NULL)) AS 'Step Counts (Day 7)',
    MAX(if(cpm.meta_key_id = 62, cpm.meta_value, NULL)) AS 'Time On (Day 7)',
    MAX(if(cpm.meta_key_id = 63, cpm.meta_value, NULL)) AS 'Time Off (Day 7)',
    MAX(if(cpm.meta_key_id = 64, cpm.meta_value, NULL)) AS 'Non Wear Time (Day 7)',
    MAX(if(cpm.meta_key_id = 65, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Day 7)',
    MAX(if(cpm.meta_key_id = 4025, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Day 7)',
    MAX(if(cpm.meta_key_id = 4026, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Day 7)',
    MAX(if(cpm.meta_key_id = 4027, cpm.meta_value, NULL)) AS 'Time Worn Score (Day 7)',
    MAX(if(cpm.meta_key_id = 4028, cpm.meta_value, NULL)) AS 'Step Counts Score (Day 7)',
    MAX(if(cpm.meta_key_id = 4029, cpm.meta_value, NULL)) AS 'First Randomized Step Counts Day',
    MAX(if(cpm.meta_key_id = 4038, cpm.meta_value, NULL)) AS 'Step Counts (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4039, cpm.meta_value, NULL)) AS 'Time On (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4040, cpm.meta_value, NULL)) AS 'Time Off (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4041, cpm.meta_value, NULL)) AS 'Non Wear Time (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4042, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4043, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4044, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4045, cpm.meta_value, NULL)) AS 'Time Worn Score (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4046, cpm.meta_value, NULL)) AS 'Step Counts Score (First Randomized Day)',
    MAX(if(cpm.meta_key_id = 4030, cpm.meta_value, NULL)) AS 'Second Randomized Step Counts Day',
    MAX(if(cpm.meta_key_id = 4047, cpm.meta_value, NULL)) AS 'Step Counts (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4048, cpm.meta_value, NULL)) AS 'Time On (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4049, cpm.meta_value, NULL)) AS 'Time Off (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4050, cpm.meta_value, NULL)) AS 'Non Wear Time (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4051, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4052, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4053, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4054, cpm.meta_value, NULL)) AS 'Time Worn Score (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4055, cpm.meta_value, NULL)) AS 'Step Counts Score (Second Randomized Day)',
    MAX(if(cpm.meta_key_id = 4031, cpm.meta_value, NULL)) AS 'Third Randomized Step Counts Day',
    MAX(if(cpm.meta_key_id = 4056, cpm.meta_value, NULL)) AS 'Step Counts (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4057, cpm.meta_value, NULL)) AS 'Time On (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4058, cpm.meta_value, NULL)) AS 'Time Off (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4059, cpm.meta_value, NULL)) AS 'Non Wear Time (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4060, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4061, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4062, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4063, cpm.meta_value, NULL)) AS 'Time Worn Score (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4064, cpm.meta_value, NULL)) AS 'Step Counts Score (Third Randomized Day)',
    MAX(if(cpm.meta_key_id = 4032, cpm.meta_value, NULL)) AS 'Fourth Randomized Step Counts Day',
    MAX(if(cpm.meta_key_id = 4065, cpm.meta_value, NULL)) AS 'Step Counts (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4066, cpm.meta_value, NULL)) AS 'Time On (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4067, cpm.meta_value, NULL)) AS 'Time Off (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4068, cpm.meta_value, NULL)) AS 'Non Wear Time (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4069, cpm.meta_value, NULL)) AS 'Reason for Non Wear Time (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4070, cpm.meta_value, NULL)) AS 'Time Worn in Hours:Minutes (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4071, cpm.meta_value, NULL)) AS 'Time Worn in Decimal Hours (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4072, cpm.meta_value, NULL)) AS 'Time Worn Score (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4073, cpm.meta_value, NULL)) AS 'Step Counts Score (Fourth Randomized Day)',
    MAX(if(cpm.meta_key_id = 4033, cpm.meta_value, NULL)) AS 'Missing Days',
    MAX(if(cpm.meta_key_id = 4034, cpm.meta_value, NULL)) AS 'Valid Days',
    MAX(if(cpm.meta_key_id = 4035, cpm.meta_value, NULL)) AS 'Invalid Days',
    MAX(if(cpm.meta_key_id = 4074, cpm.meta_value, NULL)) AS 'Pedometer Complete Data',
    MAX(if(cpm.meta_key_id = 4036, cpm.meta_value, NULL)) AS 'Pedometer Total Step Counts Score',
    MAX(if(cpm.meta_key_id = 4037, cpm.meta_value, NULL)) AS 'Pedometer Total Step Counts Interpretation',
    MAX(if(cpm.meta_key_id = 66, cpm.meta_value, NULL)) AS 'Cant Wait to Play Active Games After School (CSAPPA Item 1)',
    MAX(if(cpm.meta_key_id = 5001, cpm.meta_value, NULL)) AS 'Cant Wait to Play Active Games After School Score (CSAPPA Item 1)',
    MAX(if(cpm.meta_key_id = 67, cpm.meta_value, NULL)) AS 'Dont Like Playing Active Games (CSAPPA Item 2)',
    MAX(if(cpm.meta_key_id = 5002, cpm.meta_value, NULL)) AS 'Dont Like Playing Active Games Score (CSAPPA Item 2)',
    MAX(if(cpm.meta_key_id = 68, cpm.meta_value, NULL)) AS 'Dont Have Much Fun Playing Sports (CSAPPA Item 3)',
    MAX(if(cpm.meta_key_id = 5003, cpm.meta_value, NULL)) AS 'Dont Have Much Fun Playing Sports Score (CSAPPA Item 3)',
    MAX(if(cpm.meta_key_id = 69, cpm.meta_value, NULL)) AS 'Good at Active Games (CSAPPA Item 4)',
    MAX(if(cpm.meta_key_id = 5004, cpm.meta_value, NULL)) AS 'Good at Active Games Score (CSAPPA Item 4)',
    MAX(if(cpm.meta_key_id = 70, cpm.meta_value, NULL)) AS 'Dont Like Playing Sports (CSAPPA Item 5)',
    MAX(if(cpm.meta_key_id = 5005, cpm.meta_value, NULL)) AS 'Dont Like Playing Sports Score (CSAPPA Item 5)',
    MAX(if(cpm.meta_key_id = 71, cpm.meta_value, NULL)) AS 'Always Hurt Themselves When They Play Sports (CSAPPA Item 6)',
    MAX(if(cpm.meta_key_id = 5006, cpm.meta_value, NULL)) AS 'Always Hurt Themselves When They Play Sports Score (CSAPPA Item 6)',
    MAX(if(cpm.meta_key_id = 72, cpm.meta_value, NULL)) AS 'Like to Play Active Games Outside (CSAPPA Item 7)',
    MAX(if(cpm.meta_key_id = 5007, cpm.meta_value, NULL)) AS 'Like to Play Active Games Outside Score (CSAPPA Item 7)',
    MAX(if(cpm.meta_key_id = 73, cpm.meta_value, NULL)) AS 'Among the Last to be Chosen for Active Games (CSAPPA Item 8)',
    MAX(if(cpm.meta_key_id = 5008, cpm.meta_value, NULL)) AS 'Among the Last to be Chosen for Active Games Score (CSAPPA Item 8)',
    MAX(if(cpm.meta_key_id = 74, cpm.meta_value, NULL)) AS 'Do Well in Most Sports (CSAPPA Item 9)',
    MAX(if(cpm.meta_key_id = 5009, cpm.meta_value, NULL)) AS 'Do Well in Most Sports Score (CSAPPA Item 9)',
    MAX(if(cpm.meta_key_id = 75, cpm.meta_value, NULL)) AS 'Learn to Play Active Games Easily (CSAPPA Item 10)',
    MAX(if(cpm.meta_key_id = 5010, cpm.meta_value, NULL)) AS 'Learn to Play Active Games Easily Score (CSAPPA Item 10)',
    MAX(if(cpm.meta_key_id = 76, cpm.meta_value, NULL)) AS 'Think They are the Best at Sports (CSAPPA Item 11)',
    MAX(if(cpm.meta_key_id = 5011, cpm.meta_value, NULL)) AS 'Think They are the Best at Sports Score (CSAPPA Item 11)',
    MAX(if(cpm.meta_key_id = 77, cpm.meta_value, NULL)) AS 'Find Games in Physical Education Hard to Play (CSAPPA Item 12)',
    MAX(if(cpm.meta_key_id = 5012, cpm.meta_value, NULL)) AS 'Find Games in Physical Education Hard to Play Score (CSAPPA Item 12)',
    MAX(if(cpm.meta_key_id = 78, cpm.meta_value, NULL)) AS 'Like to Watch Games Being Played Outside (CSAPPA Item 13)',
    MAX(if(cpm.meta_key_id = 5013, cpm.meta_value, NULL)) AS 'Like to Watch Games Being Played Outside Score (CSAPPA Item 13)',
    MAX(if(cpm.meta_key_id = 79, cpm.meta_value, NULL)) AS 'Like to Take it Easy During Recess (CSAPPA Item 14)',
    MAX(if(cpm.meta_key_id = 5014, cpm.meta_value, NULL)) AS 'Like to Take it Easy During Recess Score (CSAPPA Item 14)',
    MAX(if(cpm.meta_key_id = 80, cpm.meta_value, NULL)) AS 'Arent Good Enough for Sports Teams (CSAPPA Item 15)',
    MAX(if(cpm.meta_key_id = 5015, cpm.meta_value, NULL)) AS 'Arent Good Enough for Sports Teams Score (CSAPPA Item 15)',
    MAX(if(cpm.meta_key_id = 81, cpm.meta_value, NULL)) AS 'Like to Read or Play Quiet Games (CSAPPA Item 16)',
    MAX(if(cpm.meta_key_id = 5016, cpm.meta_value, NULL)) AS 'Like to Read or Play Quiet Games Score (CSAPPA Item 16)',
    MAX(if(cpm.meta_key_id = 82, cpm.meta_value, NULL)) AS 'Like to Play Active Games Outside on Weekends (CSAPPA Item 17)',
    MAX(if(cpm.meta_key_id = 5017, cpm.meta_value, NULL)) AS 'Like to Play Active Games Outside On Weekends Score (CSAPPA Item 17)',
    MAX(if(cpm.meta_key_id = 5024, cpm.meta_value, NULL)) AS 'CSAPPA Complete Data',
    MAX(if(cpm.meta_key_id = 5018, cpm.meta_value, NULL)) AS 'CSAPPA Adequacy Sum',
    MAX(if(cpm.meta_key_id = 5019, cpm.meta_value, NULL)) AS 'CSAPPA Adequacy Score',
    MAX(if(cpm.meta_key_id = 5020, cpm.meta_value, NULL)) AS 'CSAPPA Predilection Sum',
    MAX(if(cpm.meta_key_id = 5021, cpm.meta_value, NULL)) AS 'CSAPPA Predilection Score',
    MAX(if(cpm.meta_key_id = 5022, cpm.meta_value, NULL)) AS 'Motivation and Confidence Score',
    MAX(if(cpm.meta_key_id = 5023, cpm.meta_value, NULL)) AS 'Motivation and Confidence Interpretation',
    MAX(if(cpm.meta_key_id = 83, cpm.meta_value, NULL)) AS 'How Many Minutes Should You Be Active',
    MAX(if(cpm.meta_key_id = 6007, cpm.meta_value, NULL)) AS 'How Many Minutes Should You Be Active Score',
    MAX(if(cpm.meta_key_id = 84, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - Look Better',
    MAX(if(cpm.meta_key_id = 85, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - More Energy',
    MAX(if(cpm.meta_key_id = 86, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - Feel Happier',
    MAX(if(cpm.meta_key_id = 87, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - Have Fun',
    MAX(if(cpm.meta_key_id = 88, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - Make More Friends',
    MAX(if(cpm.meta_key_id = 89, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - Get Stronger',
    MAX(if(cpm.meta_key_id = 90, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - Like Myself More',
    MAX(if(cpm.meta_key_id = 91, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - Get in Better Shape',
    MAX(if(cpm.meta_key_id = 92, cpm.meta_value, NULL)) AS 'Reason I Might Be Active - Feel Healthier',
    MAX(if(cpm.meta_key_id = 6001, cpm.meta_value, NULL)) AS 'Benefits',
    MAX(if(cpm.meta_key_id = 93, cpm.meta_value, NULL)) AS 'Might Not Be Active - Didnt Have Time',
    MAX(if(cpm.meta_key_id = 94, cpm.meta_value, NULL)) AS 'Might Not Be Active - Too Many Chores',
    MAX(if(cpm.meta_key_id = 95, cpm.meta_value, NULL)) AS 'Might Not Be Active - Didnt Have Good Place to Be Active',
    MAX(if(cpm.meta_key_id = 96, cpm.meta_value, NULL)) AS 'Might Not Be Active - Weather Too Bad',
    MAX(if(cpm.meta_key_id = 97, cpm.meta_value, NULL)) AS 'Might Not Be Active - Didnt Have Right Clothes',
    MAX(if(cpm.meta_key_id = 98, cpm.meta_value, NULL)) AS 'Might Not Be Active - Didnt Know How to Do Activity',
    MAX(if(cpm.meta_key_id = 99, cpm.meta_value, NULL)) AS 'Might Not Be Active - Didnt Have Right Equipment',
    MAX(if(cpm.meta_key_id = 100, cpm.meta_value, NULL)) AS 'Might Not Be Active - Too Much Homework',
    MAX(if(cpm.meta_key_id = 101, cpm.meta_value, NULL)) AS 'Might Not Be Active - Didnt Have Anyone to Be Active With',
    MAX(if(cpm.meta_key_id = 102, cpm.meta_value, NULL)) AS 'Might Not Be Active - Didnt Like to Be Active',
    MAX(if(cpm.meta_key_id = 6002, cpm.meta_value, NULL)) AS 'Barriers',
    MAX(if(cpm.meta_key_id = 6003, cpm.meta_value, NULL)) AS 'Benefits to Barriers Ratio',
    MAX(if(cpm.meta_key_id = 6004, cpm.meta_value, NULL)) AS 'Benefits to Barriers Ratio Score',
    MAX(if(cpm.meta_key_id = 103, cpm.meta_value, NULL)) AS 'Compared to Other Kids How Active Are You',
    MAX(if(cpm.meta_key_id = 6005, cpm.meta_value, NULL)) AS 'Compared to Other Kids How Active Are You Score',
    MAX(if(cpm.meta_key_id = 104, cpm.meta_value, NULL)) AS 'Compared to Other Kids How Good Are You at Sports',
    MAX(if(cpm.meta_key_id = 6006, cpm.meta_value, NULL)) AS 'Compared to Other Kids How Good Are You at Sports Score',
    MAX(if(cpm.meta_key_id = 105, cpm.meta_value, NULL)) AS 'Most Time Children Should Look at Screen',
    MAX(if(cpm.meta_key_id = 6008, cpm.meta_value, NULL)) AS 'Most Time Children Should Look at Screen Score',
    MAX(if(cpm.meta_key_id = 106, cpm.meta_value, NULL)) AS 'Cardiorespiratory Fitness Means',
    MAX(if(cpm.meta_key_id = 6009, cpm.meta_value, NULL)) AS 'Cardiorespiratory Fitness Means Score',
    MAX(if(cpm.meta_key_id = 107, cpm.meta_value, NULL)) AS 'Muscular Strength Means',
    MAX(if(cpm.meta_key_id = 6010, cpm.meta_value, NULL)) AS 'Muscular Strength Means Score',
    MAX(if(cpm.meta_key_id = 108, cpm.meta_value, NULL)) AS 'Healthy Means Being Skinny',
    MAX(if(cpm.meta_key_id = 109, cpm.meta_value, NULL)) AS 'Healthy Means Looking Good',
    MAX(if(cpm.meta_key_id = 110, cpm.meta_value, NULL)) AS 'Healthy Means Eating Well',
    MAX(if(cpm.meta_key_id = 111, cpm.meta_value, NULL)) AS 'Healthy Means Feeling Good',
    MAX(if(cpm.meta_key_id = 112, cpm.meta_value, NULL)) AS 'Healthy Means Not Being Sick',
    MAX(if(cpm.meta_key_id = 6011, cpm.meta_value, NULL)) AS 'Healthy Means Score',
    MAX(if(cpm.meta_key_id = 113, cpm.meta_value, NULL)) AS 'Physical Activity is',
    MAX(if(cpm.meta_key_id = 114, cpm.meta_value, NULL)) AS 'Physical Activity is Also',
    MAX(if(cpm.meta_key_id = 115, cpm.meta_value, NULL)) AS 'More Running to Improve Her',
    MAX(if(cpm.meta_key_id = 116, cpm.meta_value, NULL)) AS 'Pushups-Situps That Increase Her',
    MAX(if(cpm.meta_key_id = 117, cpm.meta_value, NULL)) AS 'Heart Rate Called a',
    MAX(if(cpm.meta_key_id = 6012, cpm.meta_value, NULL)) AS 'Fill in the Blanks Score',
    MAX(if(cpm.meta_key_id = 118, cpm.meta_value, NULL)) AS 'I Snowmobile',
    MAX(if(cpm.meta_key_id = 121, cpm.meta_value, NULL)) AS 'I Snowmobile With Safety Gear',
    MAX(if(cpm.meta_key_id = 119, cpm.meta_value, NULL)) AS 'I Swing',
    MAX(if(cpm.meta_key_id = 122, cpm.meta_value, NULL)) AS 'I Swing With Safety Gear',
    MAX(if(cpm.meta_key_id = 120, cpm.meta_value, NULL)) AS 'I Play Baseball',
    MAX(if(cpm.meta_key_id = 123, cpm.meta_value, NULL)) AS 'I Play Baseball With Safety Gear',
    MAX(if(cpm.meta_key_id = 124, cpm.meta_value, NULL)) AS 'I Toboggan',
    MAX(if(cpm.meta_key_id = 127, cpm.meta_value, NULL)) AS 'I Toboggan With Safety Gear',
    MAX(if(cpm.meta_key_id = 125, cpm.meta_value, NULL)) AS 'I Hang From Bars',
    MAX(if(cpm.meta_key_id = 128, cpm.meta_value, NULL)) AS 'I Hang From Bars With Safety Gear',
    MAX(if(cpm.meta_key_id = 126, cpm.meta_value, NULL)) AS 'I Skip',
    MAX(if(cpm.meta_key_id = 129, cpm.meta_value, NULL)) AS 'I Skip With Safety Gear',
    MAX(if(cpm.meta_key_id = 130, cpm.meta_value, NULL)) AS 'I Swim',
    MAX(if(cpm.meta_key_id = 133, cpm.meta_value, NULL)) AS 'I Swim With Safety Gear',
    MAX(if(cpm.meta_key_id = 131, cpm.meta_value, NULL)) AS 'I Inline Skate',
    MAX(if(cpm.meta_key_id = 132, cpm.meta_value, NULL)) AS 'I Cross Country Ski',
    MAX(if(cpm.meta_key_id = 135, cpm.meta_value, NULL)) AS 'I Cross Country Ski With Safety Gear',
    MAX(if(cpm.meta_key_id = 134, cpm.meta_value, NULL)) AS 'I Inline Skate With Safety Gear',
    MAX(if(cpm.meta_key_id = 136, cpm.meta_value, NULL)) AS 'I Bike',
    MAX(if(cpm.meta_key_id = 138, cpm.meta_value, NULL)) AS 'I Bike With Safety Gear',
    MAX(if(cpm.meta_key_id = 137, cpm.meta_value, NULL)) AS 'I Skate',
    MAX(if(cpm.meta_key_id = 139, cpm.meta_value, NULL)) AS 'I Skate With Safety Gear',
    MAX(if(cpm.meta_key_id = 6013, cpm.meta_value, NULL)) AS 'Activities Score',
    MAX(if(cpm.meta_key_id = 140, cpm.meta_value, NULL)) AS 'Best Thing to Do to Get Better at Sport Skill',
    MAX(if(cpm.meta_key_id = 6014, cpm.meta_value, NULL)) AS 'Best Thing to Do to Get Better at Sport Skill Score',
    MAX(if(cpm.meta_key_id = 141, cpm.meta_value, NULL)) AS 'Best Thing to Do to Improve Fitness',
    MAX(if(cpm.meta_key_id = 6015, cpm.meta_value, NULL)) AS 'Best Thing to Do to Improve Fitness Score',
    MAX(if(cpm.meta_key_id = 142, cpm.meta_value, NULL)) AS 'Which Activity Would You Choose to Do After School',
    MAX(if(cpm.meta_key_id = 6016, cpm.meta_value, NULL)) AS 'Which Activity Would You Choose to Do After School Score',
    MAX(if(cpm.meta_key_id = 143, cpm.meta_value, NULL)) AS 'How Many Hours Do You Watch TV on School Days',
    MAX(if(cpm.meta_key_id = 144, cpm.meta_value, NULL)) AS 'How Many Hours Do You Play Video-Computer Games on School Days',
    MAX(if(cpm.meta_key_id = 145, cpm.meta_value, NULL)) AS 'How Many Hours Do You Watch TV on Weekend Days',
    MAX(if(cpm.meta_key_id = 146, cpm.meta_value, NULL)) AS 'How Many Hours Do You Play Video-Computer Games on Weekend Days',
    MAX(if(cpm.meta_key_id = 6033, cpm.meta_value, NULL)) AS 'Average Daily TV Time (Decimal Hours)',
    MAX(if(cpm.meta_key_id = 6034, cpm.meta_value, NULL)) AS 'Average Daily Computer Time (Decimal Hours)',
    MAX(if(cpm.meta_key_id = 6035, cpm.meta_value, NULL)) AS 'Average Daily Screen Time (Decimal Hours)',
    MAX(if(cpm.meta_key_id = 147, cpm.meta_value, NULL)) AS 'In Past Week How Many Days Physically Active for at Least 60 Minutes',
    MAX(if(cpm.meta_key_id = 6021, cpm.meta_value, NULL)) AS 'In Past Week How Many Days Physically Active for at Least 60 Minutes Score',
    MAX(if(cpm.meta_key_id = 6022, cpm.meta_value, NULL)) AS 'In Past Week How Many Days Physically Active for at Least 60 Minutes Interpretation',
    MAX(if(cpm.meta_key_id = 148, cpm.meta_value, NULL)) AS 'How Many Hours Do You Spend Doing Non Screen Sedentary Activities on School Days',
    MAX(if(cpm.meta_key_id = 6017, cpm.meta_value, NULL)) AS 'School Day Screen Time Score',
    MAX(if(cpm.meta_key_id = 149, cpm.meta_value, NULL)) AS 'How Many Hours Do You Spend Doing Non Screen Sedentary Activities on Weekend Days',
    MAX(if(cpm.meta_key_id = 6036, cpm.meta_value, NULL)) AS 'Average Daily Non-Screen-Based Sedentary Time (Decimal Hours)',
    MAX(if(cpm.meta_key_id = 6018, cpm.meta_value, NULL)) AS 'Weekend Day Screen Time Score',
    MAX(if(cpm.meta_key_id = 6019, cpm.meta_value, NULL)) AS 'Total Screen Time Score',
    MAX(if(cpm.meta_key_id = 6020, cpm.meta_value, NULL)) AS 'Total Screen Time Interpretation',
    MAX(if(cpm.meta_key_id = 6031, cpm.meta_value, NULL)) AS 'Knowledge and Understanding Complete Data',
    MAX(if(cpm.meta_key_id = 6023, cpm.meta_value, NULL)) AS 'Knowledge and Understanding Score',
    MAX(if(cpm.meta_key_id = 6024, cpm.meta_value, NULL)) AS 'Knowledge and Understanding Interpretation',
    MAX(if(cpm.meta_key_id = 6025, cpm.meta_value, NULL)) AS 'Daily Behaviour Score',
    MAX(if(cpm.meta_key_id = 6026, cpm.meta_value, NULL)) AS 'Daily Behaviour Interpretation',
    MAX(if(cpm.meta_key_id = 6032, cpm.meta_value, NULL)) AS 'CAPL Complete Data',
    MAX(if(cpm.meta_key_id = 6027, cpm.meta_value, NULL)) AS 'CAPL Score',
    MAX(if(cpm.meta_key_id = 6028, cpm.meta_value, NULL)) AS 'CAPL Interpretation'
  FROM capl_participants cp
    INNER JOIN capl_participants_metadata cpm ON cp.participant_id = cpm.participant_id
  WHERE cpm.time_point = 1
  GROUP BY cp.participant_id ORDER BY cp.sort_order ASC
"
q <- dbSendQuery(mydb, q_statement)

# Retrieve data from query
data <- fetch(q, n = -1)

# Export data to csv
write.csv(data, "data.csv", row.names = FALSE, na = "")

# Clear the query
dbClearResult(q)
